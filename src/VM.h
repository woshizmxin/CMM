/*
    VM.h
    ====
        Class __VM header.
*/

#pragma once

#include <vector>
#include <utility>
#include "Instruction.hpp"

namespace CMM
{

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Using
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

using std::vector;
using std::pair;


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Class __VM
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

class __VM
{
    // Friend
    friend class Core;


public:

    // Constructor
    explicit __VM(const vector<pair<__Instruction, int>> &CS);


private:

    // Attribute
    vector<pair<__Instruction, int>> __CS;
    int __IP;
    int __AX;
    int __BP;
    vector<int> __SS;


    // Exec __Instruction
    void __execInstruction(const pair<__Instruction, int> &instructionPair);


    // Run
    void __run();
};


}  // End namespace CMM
